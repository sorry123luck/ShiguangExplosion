# ShiguangExplosion 自动化助手

🧠 基于 Python + ADB + 模拟器画面识别的全自动化游戏任务助手，适用于《时光大爆炸》手游自动采集、科技研究、远征挑战、裂隙闯关等功能。

---

## ✨ 功能特色

- ✅ **科技研究自动化**
  - 自动识别研究完成图标，点击进入研究流程
  - OCR 识别剩余研究时间和加速冷却时间
  - 自动点击“加速”和“联盟求助”
  - 加速冷却完成后自动尝试免费加速

- 📦 **资源采集模块**
  - 支持选择性采集：木材、食物、石头、铜矿、铁矿
  - 全资源同步点击模式（适用于高效批量采集）
  - 自动检测“助力”图标与聊天界面自动关闭
  - 联动远征模块：检测“摸鱼图标”自动跳转

- 🚀 **远征任务处理**
  - 自动点击远征入口、事件、联盟资源页签
  - OCR 识别空闲部队、侦察体力等状态
  - 多轮翻页寻找可出兵资源点
  - 自动点击事件详情 → 出兵 → 返回事件页

- ⚔️ **裂隙挑战模块**
  - 自动切换视频流模式，获取高清实时帧
  - 自动识别“扫荡”、“开始挑战”、“跳过”、“失败弹窗”等
  - 连续失败达指定次数后退出回主页
  - 战斗跳过后识别胜负状态，自动继续挑战

---

## 🖥️ 主控界面功能

启动后提供完整 GUI 控制面板：

- 启用模块勾选（采集 / 远征 / 裂隙 / 科技）
- 当前运行状态监控
- 科技剩余时间 / 加速CD 实时更新
- 裂隙失败次数可配置
- 手动触发按钮：科技研究、远征任务、裂隙挑战
- 一键暂停 / 启动 / 退出

---

## 🧩 模块结构说明

| 模块文件             | 说明                       |
|----------------------|----------------------------|
| `main_controller.py` | 主控界面与任务调度核心     |
| `tech_research_core.py` | 科技研究模块逻辑处理       |
| `rift_core.py`       | 裂隙挑战视频识别模块       |
| `collect_core.py`    | 资源采集与助力检测模块     |
| `expedition_core.py` | 自动远征模块               |
| `tech_timer_manager.py` | 科技研究 / 加速倒计时管理 |
| `global_state.py`    | 全局状态和任务标志变量     |
| `position_config.py` | 坐标和识别区域配置         |
| `adb_tools.py`       | ADB控制 / 截图 / 视频流连接 |
| `frame_listener.py`  | 视频流 H264 解码监听器     |
| `toast_notify.py`    | Toast 弹窗与日志通知        |

---

## ⚙️ 环境依赖

- Python 3.8+
- OpenCV (`opencv-python`)
- EasyOCR (`easyocr`)
- pytesseract
- av (`PyAV`, 用于解析视频帧)
- numpy
- Pillow

确保模拟器开启 root 权限，ADB 调试开启，且端口 `6100/6101/6102` 可通信。

---

## 🚀 启动方式

```bash
python main_controller.py
